!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.FullpageSwiper=e():t.FullpageSwiper=e()}(this,function(){return function(t){var e={};function n(i){if(e[i])return e[i].exports;var o=e[i]={i:i,l:!1,exports:{}};return t[i].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=t,n.c=e,n.d=function(t,e,i){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)n.d(i,o,function(e){return t[e]}.bind(null,o));return i},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=0)}([function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}();var o=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.containerRef=document.querySelector(e),this.containerType=this.containerRef.getAttribute("data-stack-type"),this.containerRef&&this.containerType?(this.containerAxis="top"===this.containerType||"y"===this.containerType?"vertical":"horizontal",this.options=Object.assign({debug:!1},n),this.parents=[],this.stacks=[],this.hammers=[],this.currentIdx=0,this.eventType={axis:"",direction:""},this.dragging=!1,this.draggingRef=null,this.viewport=t.getViewport(),this.setStacks(),this.setCommonLayout(),this.setLayout(),this._addEvents(),this.options.debug&&this.debug()):console.error("fullpage-swiper initialization error, check selector",e)}return i(t,null,[{key:"getViewport",value:function(){return{clientWidth:window.innerWidth||document.documentElement.clientWidth,clientHeight:window.innerHeight||document.documentElement.clientHeight}}},{key:"getRandomColor",value:function(){for(var t="#",e=0;e<6;e++)t+="0123456789ABCDEF"[Math.floor(16*Math.random())];return t}}]),i(t,[{key:"removeListeners",value:function(){}},{key:"_blockEvent",value:function(t){return""===this.eventType.axis?(this._updateEventType(t),!1):!this.isDragging||this.eventType.axis!==t.axis||void this._updateEventType(t)}},{key:"_updateEventType",value:function(t){this.eventType.axis=t.axis,this.eventType.direction=t.direction}},{key:"_resetDrag",value:function(){this.dragging=!1,this.eventType={target:null,axis:"",direction:""},this.draggingRef=null}},{key:"_panstart",value:function(t){this.isDragging=!0,this.eventTarget=this.stacks.find(function(e){return e.node===t.currentTarget}),this.eventTarget?this.options.dragStart(this):this.isDragging=!1}},{key:"_panleft",value:function(t){var e={axis:"horizontal",direction:"left"};if(!this._blockEvent(e)){if(console.log("START:",e.direction),!this.draggingRef){var n=this.eventTarget;n&&(this.draggingRef=n.nextStackView[e.direction],this.eventType.target=n,console.log("START:",this.draggingRef,n))}this.draggingRef?this._dragging(this.draggingRef,t):this._resetDrag()}}},{key:"_panright",value:function(t){var e={axis:"horizontal",direction:"right"};if(!this._blockEvent(e)){if(!this.draggingRef){var n=this.eventTarget;n&&(this.draggingRef=n.nextStackView[e.direction],this.eventType.target=n)}this.draggingRef?this._dragging(this.draggingRef,t):this._resetDrag()}}},{key:"_pandown",value:function(t){var e={axis:"vertical",direction:"down"};if(!this._blockEvent(e)){if(!this.draggingRef){var n=this.eventTarget;n&&(this.draggingRef=n.nextStackView[e.direction],this.eventType.target=n)}this.draggingRef?this._dragging(this.draggingRef,t):this._resetDrag()}}},{key:"_panup",value:function(t){var e={axis:"vertical",direction:"up"};if(!this._blockEvent(e)){if(!this.draggingRef){var n=this.eventTarget;n&&(this.draggingRef=n.nextStackView[e.direction],this.eventType.target=n)}this.draggingRef?this._dragging(this.draggingRef,t):this._resetDrag()}}},{key:"_endCallback",value:function(){var t=this.stackMoveFromTo,e=t.to;t.toParent&&(e>=0?t.toParent.lastSeenIndex=e:(t.toParent.lastSeenIndex=this.currentIdx,t.to=this.currentIdx)),this.options.dragEnd(this),this._resetDrag()}},{key:"_panend",value:function(){var t=this;if(this.draggingRef){var e=this.draggingRef,n=this.eventType,i=e.type,o=n.direction,r=this.viewport,s=r.clientHeight,a=r.clientWidth,l=gsap.timeline();if("top"===i&&("up"===o&&(this.eventTarget.node!==e.node&&(this.stackMoveFromTo.to=this.currentIdx),l.to(e.node,{top:-s}).add(function(){e.positions.top=-s,t._endCallback()})),"down"===o&&(this.eventTarget.node===e.node&&(this.stackMoveFromTo.to=this.currentIdx),l.to(e.node,{top:0}).add(function(){e.positions.top=0,t._endCallback()}))),"left"===i&&("left"===this.eventType.direction&&l.to(e.node,{left:-a}).add(function(){e.positions.left=-a,t._endCallback()}),"right"===this.eventType.direction&&l.to(e.node,{left:0}).add(function(){e.positions.left=0,t._endCallback()})),"y"===i){var d=e.positions.y;if("up"===o){var h=d;if(this.snapshotPositions.y<d){h=d-s;var c=-s*(e.children.length-1);h<c&&(h=c)}else this.stackMoveFromTo.to=this.currentIdx;l.to(e.node,{y:h}).add(function(){e.positions.y=h,t._endCallback()})}if("down"===o){var p=d;this.snapshotPositions.y>d?(p=d+s)>=0&&(p=0):this.stackMoveFromTo.to=this.currentIdx,l.to(e.node,{y:p}).add(function(){e.positions.y=p,t._endCallback()})}}if("x"===i){var f=e.positions.x;if("left"===o){var u=f;if(this.snapshotPositions.x<f){u=f-a;var g=-a*(e.children.length-1);u<g&&(u=g)}else this.stackMoveFromTo.to=this.currentIdx;l.to(e.node,{x:u}).add(function(){e.positions.x=u,t._endCallback()})}if("right"===o){var y=f;this.snapshotPositions.x>f?(y=f+a)>=0&&(y=0):this.stackMoveFromTo.to=this.currentIdx,l.to(e.node,{x:y}).add(function(){e.positions.x=y,t._endCallback()})}}}else this._resetDrag()}},{key:"_dragging",value:function(t,e){var n=this,i=t.type,o=this.viewport,r=o.clientHeight,s=o.clientWidth;this.snapshotPositions={top:0,left:0,x:0,y:0};var a=this.snapshotPositions,l=void 0,d=void 0,h=this.stacks.find(function(t){return t.node===n.eventTarget.node});if("y"===i){if((l=e.deltaY+t.positions.y)>=0)return t.positions.y=0,t.node.style.transform="translate3d(0px, 0px, 0px)",void(this.draggingRef=h[this.eventType.direction]);var c=-r*(t.children.length-1);if(l<=c)return t.positions.y=c,t.node.style.transform="translate3d(0px, "+c+"px, 0px)",void(this.draggingRef=h[this.eventType.direction]);a.y=l,gsap.set(t.node,{y:l})}if("x"===i){if((d=e.deltaX+t.positions.x)>=0)return t.positions.x=0,t.node.style.transform="translate3d(0px, 0px, 0px)",void(this.draggingRef=h[this.eventType.direction]);var p=-s*(t.children.length-1);if(d<=p)return t.positions.x=p,t.node.style.transform="translate3d("+p+"px, 0px, 0px)",void(this.draggingRef=h[this.eventType.direction]);a.x=d,gsap.set(t.node,{x:d})}if("top"===i){if((l=e.deltaY+t.positions.top)>=0)return t.positions.top=0,t.node.style.top="0px",void(this.draggingRef=h[this.eventType.direction]);if(l<=-r)return t.positions.top=-r,t.node.style.top=-r+"px",void(this.draggingRef=h[this.eventType.direction]);a.top=l,gsap.set(t.node,{top:l})}if("left"===i){if((d=t.positions.left+e.deltaX)>=0)return t.positions.left=0,t.node.style.left="0px",void(this.draggingRef=h[this.eventType.direction]);if(d<=-s)return t.positions.left=-s,t.node.style.left=-s+"px",void(this.draggingRef=h[this.eventType.direction]);a.left=d,gsap.set(t.node,{left:d})}this.stackMoveFromTo=this._getStackMoveFromTo(),this.options.dragMove(this)}},{key:"_getStackMoveFromTo",value:function(){var t=this.eventType.direction,e=this.eventType.axis,n=this.eventTarget,i=n.stackIndex,o=n.isFirstNode,r=n.isLastNode,s={direction:t,type:this.draggingRef.type,from:null,to:null,toParent:null,isTopLevelMove:!1},a=this.parents.findIndex(function(t){return t.node===n.innerParent.node}),l=this.parents[a],d="vertical"===l.axis&&"up"===t||"horizontal"===l.axis&&"left"===t,h="vertical"===l.axis&&"down"===t||"horizontal"===l.axis&&"right"===t,c=e===this.containerAxis;if(l.axis!==e&&c){if(s.from=i,"up"===t||"left"===t){var p=this.parents[a+1];p&&(s.isTopLevelMove=!0,p.lastSeenIndex?(s.to=p.lastSeenIndex,s.toParent=p):(s.to=l.children[l.children.length-1].stackIndex+1,s.toParent=p))}if("down"===t||"right"===t){var f=this.parents[a-1];f&&(s.isTopLevelMove=!0,f.lastSeenIndex?(s.to=f.lastSeenIndex,s.toParent=f):(s.to=l.children[0].stackIndex-1,s.toParent=f))}}if(d)if(s.from=i,r){if(c){var u=this.parents[a+1];u&&(s.isTopLevelMove=!0,u.lastSeenIndex?(s.to=u.lastSeenIndex,s.toParent=u):(s.to=i+1,s.toParent=u))}}else s.to=i+1,s.toParent=l;if(h)if(s.from=i,o){if(c){var g=this.parents[a-1];g&&(s.isTopLevelMove=!0,g.lastSeenIndex?(s.to=g.lastSeenIndex,s.toParent=g):(s.to=i-1,s.toParent=g))}}else s.to=i-1,s.toParent=l;return s}},{key:"_addEvents",value:function(){var t=this,e=new Hammer(this.containerRef);this.hammers.push(e),e.add(new Hammer.Pan({direction:Hammer.DIRECTION_ALL,threshold:this.options.threshold})),this.stacks.forEach(function(e){e.node.addEventListener("touchstart",t._panstart.bind(t),!1)}),e.on("panend",this._panend.bind(this)),e.on("panleft",this._panleft.bind(this)),e.on("panright",this._panright.bind(this)),e.on("pandown",this._pandown.bind(this)),e.on("panup",this._panup.bind(this))}},{key:"setCommonLayout",value:function(){document.body.style.overflow="hidden",document.body.style.height="100%",document.body.style.width="100%",document.documentElement.style.overflow="hidden",document.documentElement.style.height="100%",document.documentElement.style.width="100%"}},{key:"setLayout",value:function(){var e=this;this.viewport=t.getViewport(),this.parents.forEach(function(t){switch(t.type){case"x":return void e._layoutX(t);case"y":return void e._layoutY(t);case"top":case"left":return void e._layoutFixed(t)}})}},{key:"_layoutX",value:function(t){var e=this.viewport,n=e.clientHeight,i=e.clientWidth,o=t.node,r=t.children;o.x=o.y=0,o.style.display="flex",o.style.overflow="hidden",o.style.position="relative",o.style.width=i*r.length+"px",o.style.transform="translate3d(0px, 0px, 0px)",r.forEach(function(t){var e=t.node;e.style.width=i+"px",e.style.height=n+"px"})}},{key:"_layoutY",value:function(t){var e=this.viewport.clientHeight,n=t.node,i=t.children;n.x=n.y=0,n.style.overflow="hidden",n.style.position="relative",n.style.height=e*i.length+"px",n.style.transform="translate3d(0px, 0px, 0px)",i.forEach(function(t){t.node.style.height=e+"px"})}},{key:"_layoutFixed",value:function(t){var e=this.viewport,n=e.clientHeight,i=e.clientWidth,o=t.node,r=t.children;o.style.overflow="hidden",o.style.position="relative",o.style.height=n+"px",o.style.width=i+"px",r.forEach(function(t,e,o){var r=t.node;r.style.position="absolute",r.style.top=0,r.style.left=0,r.style.height=n+"px",r.style.width=i+"px",r.style.zIndex=10*(o.length-e)})}},{key:"setStacks",value:function(){var t=this,e=document.createTreeWalker(this.containerRef,NodeFilter.SHOW_ELEMENT,function(t){return t&&"string"==typeof t.getAttribute("data-stack")?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP},!1);this.parents=Array.from(document.querySelectorAll("[data-stack-type]")).map(function(e){var n=e.getAttribute("data-stack-type");return{type:n,axis:"top"===n||"y"===n?"vertical":"horizontal",node:e,children:e===t.containerRef?Array.from(e.children).filter(function(t){return"string"==typeof t.getAttribute("data-stack")}):Array.from(e.querySelectorAll("[data-stack]")).filter(function(t){return"string"==typeof t.getAttribute("data-stack")}),positions:{x:0,y:0,top:0,left:0}}});for(var n=e.firstChild(),i=function(){for(var i=n.parentNode,o=void 0;null!==i&&!(o=i.getAttribute("data-stack-type"));)i=i.parentNode;var r="top"===o||"y"===o?"vertical":"horizontal",s=t.parents.find(function(t){return t.node===i});if(s.isRoot=s.node===t.containerRef,s.node===t.containerRef)s.outerParent=null;else{var a=t.parents[0].children.find(function(t){return t.node.querySelector("[data-stack-type]")});a&&(s.outerParent=a)}var l=s.children.findIndex(function(t){return t===n}),d={type:o,axis:r,node:n,siblingIndex:l,innerParent:s,isRootLevel:null===s.outerParent,children:s.children,isFirstNode:null===n.previousElementSibling,isLastNode:null===n.nextElementSibling,positions:{x:0,y:0,top:0,left:0}};s.children[l]=d;var h=e.firstChild();if(h)n=h;else{var c=e.nextSibling();n=c||(e.parentNode()?e.nextSibling():null)}t.stacks.push(d)};null!==n;)i();this.stacks=this.stacks.filter(function(t){return!t.isRootLevel}).map(function(e,n,i){return e.stackIndex=n,e.nextStackView=t._setPrevNextTarget(e,i),e}),console.log("parents",this.parents),console.log("this.stacks",this.stacks)}},{key:"_setPrevNextTarget",value:function(t){t.stackIndex;var e=t.stackIndex,n=t.siblingIndex,i=t.type,o=t.axis,r=t.isRootLevel,s=t.isFirstNode,a=t.isLastNode,l=t.innerParent,d=t.children,h={up:!1,down:!1,left:!1,right:!1};if(t.results={up:null,down:null,left:null,right:null},r)"y"===i&&(a||(h.up=l),s||(h.down=l)),"x"===i&&(a||(h.left=l),s||(h.right=l)),"top"===i&&(a||(h.up=d[n]),s||(h.down=d[n-1])),"left"===i&&(a||(h.left=d[n]),s||(h.right=d[n-1]));else{var c=l.outerParent;"vertical"===o&&(c.isLastNode||("left"===c.type&&(h.left=c.children[c.siblingIndex]),"x"===c.type&&(h.left=c.innerParent)),c.isFirstNode||("left"===c.type&&(h.right=c.children[c.siblingIndex-1]),"x"===c.type&&(h.right=c.innerParent))),"y"===i&&(a?c.isLastNode||("top"===c.type&&(h.up=c.children[c.siblingIndex]),"y"===c.type&&(h.up=c.innerParent)):(h.up=l,t.results.up={type:i,from:e,to:e+1}),s?c.isFirstNode||("top"===c.type&&(h.down=c.children[c.siblingIndex-1]),"y"===c.type&&(h.down=c.innerParent)):(h.down=l,t.results.down={type:i,from:e,to:e-1})),"top"===i&&(a?c.isLastNode||("top"===c.type&&(h.up=c.children[c.siblingIndex]),"y"===c.type&&(h.up=c.innerParent)):(h.up=d[n],t.results.up={type:i,from:e,to:e+1}),s?c.isFirstNode||("top"===c.type&&(h.down=c.children[c.siblingIndex-1]),"y"===c.type&&(h.down=c.innerParent)):(h.down=d[n-1],t.results.down={type:i,from:e,to:e-1})),"horizontal"===o&&("top"===c.type&&(c.isLastNode||(h.up=c.children[c.siblingIndex]),c.isFirstNode||(h.down=c.children[c.siblingIndex-1])),"y"===c.type&&(h.up=c.innerParent,h.down=c.innerParent)),"x"===i&&(a?c.isLastNode||("left"===c.type&&(h.left=c.children[c.siblingIndex]),"x"===c.type&&(h.left=c.innerParent)):(h.left=l,t.results.left={type:i,from:e,to:e+1}),s?c.isFirstNode||("left"===c.type&&(h.right=c.children[c.siblingIndex-1]),"x"===c.type&&(h.right=c.innerParent)):(h.right=l,t.results.right={type:i,from:e,to:e-1})),"left"===i&&(a?c.isLastNode||("left"===c.type&&(h.left=c.children[c.siblingIndex]),"x"===c.type&&(h.left=c.innerParent)):(h.left=d[n],t.results.left={type:i,from:e,to:e+1}),s?c.isFirstNode||("left"===c.type&&(h.right=c.children[c.siblingIndex-1]),"x"===c.type&&(h.right=c.innerParent)):(h.right=d[n-1],t.results.right={type:i,from:e,to:e-1}))}return h}},{key:"debug",value:function(){this.stacks.forEach(function(e){var n=t.getRandomColor();e.node.style.backgroundColor=n}),console.log("STACK_PARENTS: ",this.parents),console.log("STACK_VIEW: ",this.stacks),window.fps=this}}]),t}();e.default=o,t.exports=e.default}])});